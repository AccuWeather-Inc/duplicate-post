{"version":3,"sources":["@wordpress/edit-post/src/editor.js"],"names":["Editor","arguments","getEditorSettings","maxSize","settings","hasFixedToolbar","focusMode","hasReducedUI","hasThemeStyles","hiddenBlockTypes","blockTypes","preferredStyleVariations","__experimentalLocalAutosaveInterval","__experimentalSetIsInserterOpened","updatePreferredStyleVariations","keepCaretInsideBlock","__experimentalPreferredStyleVariations","value","onChange","styles","defaultEditorStyles","defaultAllowedBlockTypes","allowedBlockTypes","without","props","post","postId","initialEdits","onError","setIsInserterOpened","editorSettings","preventEventDiscovery","Component","select","postType","isFeatureActive","getPreference","__experimentalGetPreviewDeviceType","getEntityRecord","getBlockTypes","dispatch"],"mappings":";;;;;;;;;AAeA;;;;;;;;;;;;;;;;;;;;AAZA;;AACA;;AAKA;;AACA;;AAMA;;AAKA;;AAKA;;AACA;;AACA;;AACA;;;;;;;;;;IAEMA,M;;;;;AACL,oBAAc;AAAA;;AAAA;AACb,+BAAUC,SAAV;AAEA,UAAKC,iBAAL,GAAyB,qBAAQ,MAAKA,iBAAb,EAAgC;AACxDC,MAAAA,OAAO,EAAE;AAD+C,KAAhC,CAAzB;AAHa;AAMb;;;;sCAGAC,Q,EACAC,e,EACAC,S,EACAC,Y,EACAC,c,EACAC,gB,EACAC,U,EACAC,wB,EACAC,mC,EACAC,iC,EACAC,8B,EACAC,oB,EACC;AACDX,MAAAA,QAAQ,mCACFI,cAAc,GAChBJ,QADgB,GAEhB,kBAAMA,QAAN,EAAgB,CAAE,qBAAF,CAAhB,CAHI;AAIPY,QAAAA,sCAAsC,EAAE;AACvCC,UAAAA,KAAK,EAAEN,wBADgC;AAEvCO,UAAAA,QAAQ,EAAEJ;AAF6B,SAJjC;AAQPT,QAAAA,eAAe,EAAfA,eARO;AASPC,QAAAA,SAAS,EAATA,SATO;AAUPC,QAAAA,YAAY,EAAZA,YAVO;AAWPK,QAAAA,mCAAmC,EAAnCA,mCAXO;AAaP;AACAC,QAAAA,iCAAiC,EAAjCA,iCAdO;AAePE,QAAAA,oBAAoB,EAApBA,oBAfO;AAgBPI,QAAAA,MAAM,EAAEX,cAAc,GACnBJ,QAAQ,CAACe,MADU,GAEnBf,QAAQ,CAACgB;AAlBL,QAAR,CADC,CAsBD;;AACA,UAAK,kBAAMX,gBAAN,IAA2B,CAAhC,EAAoC;AACnC;AACA;AACA;AACA,YAAMY,wBAAwB,GAC7B,SAASjB,QAAQ,CAACkB,iBAAlB,GACG,iBAAKZ,UAAL,EAAiB,MAAjB,CADH,GAEGN,QAAQ,CAACkB,iBAAT,IAA8B,EAHlC;AAKAlB,QAAAA,QAAQ,CAACkB,iBAAT,GAA6BC,+BAC5BF,wBAD4B,0CAEzBZ,gBAFyB,GAA7B;AAIA;;AAED,aAAOL,QAAP;AACA;;;6BAEQ;AAAA,wBAmBJ,KAAKoB,KAnBD;AAAA,UAEPpB,QAFO,eAEPA,QAFO;AAAA,UAGPC,eAHO,eAGPA,eAHO;AAAA,UAIPC,SAJO,eAIPA,SAJO;AAAA,UAKPC,YALO,eAKPA,YALO;AAAA,UAMPC,cANO,eAMPA,cANO;AAAA,UAOPiB,IAPO,eAOPA,IAPO;AAAA,UAQPC,MARO,eAQPA,MARO;AAAA,UASPC,YATO,eASPA,YATO;AAAA,UAUPC,OAVO,eAUPA,OAVO;AAAA,UAWPnB,gBAXO,eAWPA,gBAXO;AAAA,UAYPC,UAZO,eAYPA,UAZO;AAAA,UAaPC,wBAbO,eAaPA,wBAbO;AAAA,UAcPC,mCAdO,eAcPA,mCAdO;AAAA,UAePiB,mBAfO,eAePA,mBAfO;AAAA,UAgBPf,8BAhBO,eAgBPA,8BAhBO;AAAA,UAiBPC,oBAjBO,eAiBPA,oBAjBO;AAAA,UAkBJS,KAlBI;;AAqBR,UAAK,CAAEC,IAAP,EAAc;AACb,eAAO,IAAP;AACA;;AAED,UAAMK,cAAc,GAAG,KAAK5B,iBAAL,CACtBE,QADsB,EAEtBC,eAFsB,EAGtBC,SAHsB,EAItBC,YAJsB,EAKtBC,cALsB,EAMtBC,gBANsB,EAOtBC,UAPsB,EAQtBC,wBARsB,EAStBC,mCATsB,EAUtBiB,mBAVsB,EAWtBf,8BAXsB,EAYtBC,oBAZsB,CAAvB;AAeA,aACC,4BAAC,mBAAD,QACC,4BAAC,yBAAD,CAAkB,QAAlB;AAA2B,QAAA,KAAK,EAAGX;AAAnC,SACC,4BAAC,4BAAD,QACC,4BAAC,4BAAD,QACC,4BAAC,sBAAD;AACC,QAAA,QAAQ,EAAG0B,cADZ;AAEC,QAAA,IAAI,EAAGL,IAFR;AAGC,QAAA,YAAY,EAAGE,YAHhB;AAIC,QAAA,cAAc,EAAG;AAJlB,SAKMH,KALN,GAOC,4BAAC,qBAAD;AAAe,QAAA,OAAO,EAAGI;AAAzB,SACC,4BAAC,6BAAD;AAAsB,QAAA,MAAM,EAAGF;AAA/B,QADD,EAEC,4BAAC,eAAD,OAFD,EAGC,4BAAC,6BAAD;AACC,QAAA,SAAS,EAAGK;AADb,QAHD,CAPD,EAcC,4BAAC,uBAAD,OAdD,CADD,CADD,CADD,CADD,CADD;AA0BA;;;EAjImBC,kB;;eAoIN,sBAAS,CACvB,sBAAY,UAAEC,MAAF,QAAoC;AAAA,MAAxBP,MAAwB,QAAxBA,MAAwB;AAAA,MAAhBQ,QAAgB,QAAhBA,QAAgB;;AAAA,gBAK3CD,MAAM,CAAE,gBAAF,CALqC;AAAA,MAE9CE,eAF8C,WAE9CA,eAF8C;AAAA,MAG9CC,aAH8C,WAG9CA,aAH8C;AAAA,MAI9CC,kCAJ8C,WAI9CA,kCAJ8C;;AAAA,iBAMnBJ,MAAM,CAAE,MAAF,CANa;AAAA,MAMvCK,eANuC,YAMvCA,eANuC;;AAAA,iBAOrBL,MAAM,CAAE,aAAF,CAPe;AAAA,MAOvCM,aAPuC,YAOvCA,aAPuC;;AAS/C,SAAO;AACNlC,IAAAA,eAAe,EACd8B,eAAe,CAAE,cAAF,CAAf,IACAE,kCAAkC,OAAO,SAHpC;AAIN/B,IAAAA,SAAS,EAAE6B,eAAe,CAAE,WAAF,CAJpB;AAKN5B,IAAAA,YAAY,EAAE4B,eAAe,CAAE,WAAF,CALvB;AAMN3B,IAAAA,cAAc,EAAE2B,eAAe,CAAE,aAAF,CANzB;AAONV,IAAAA,IAAI,EAAEa,eAAe,CAAE,UAAF,EAAcJ,QAAd,EAAwBR,MAAxB,CAPf;AAQNf,IAAAA,wBAAwB,EAAEyB,aAAa,CACtC,0BADsC,CARjC;AAWN3B,IAAAA,gBAAgB,EAAE2B,aAAa,CAAE,kBAAF,CAXzB;AAYN1B,IAAAA,UAAU,EAAE6B,aAAa,EAZnB;AAaN3B,IAAAA,mCAAmC,EAAEwB,aAAa,CACjD,uBADiD,CAb5C;AAgBNrB,IAAAA,oBAAoB,EAAEoB,eAAe,CAAE,sBAAF;AAhB/B,GAAP;AAkBA,CA3BD,CADuB,EA6BvB,wBAAc,UAAEK,QAAF,EAAgB;AAAA,kBAIzBA,QAAQ,CAAE,gBAAF,CAJiB;AAAA,MAE5B1B,8BAF4B,aAE5BA,8BAF4B;AAAA,MAG5Be,mBAH4B,aAG5BA,mBAH4B;;AAK7B,SAAO;AACNf,IAAAA,8BAA8B,EAA9BA,8BADM;AAENe,IAAAA,mBAAmB,EAAnBA;AAFM,GAAP;AAIA,CATD,CA7BuB,CAAT,EAuCV7B,MAvCU,C","sourcesContent":["/**\n * External dependencies\n */\nimport memize from 'memize';\nimport { size, map, without, omit } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport {\n\tEditorProvider,\n\tErrorBoundary,\n\tPostLockedModal,\n} from '@wordpress/editor';\nimport { StrictMode, Component } from '@wordpress/element';\nimport {\n\tKeyboardShortcuts,\n\tSlotFillProvider,\n\tDropZoneProvider,\n} from '@wordpress/components';\nimport { compose } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport preventEventDiscovery from './prevent-event-discovery';\nimport Layout from './components/layout';\nimport EditorInitialization from './components/editor-initialization';\nimport EditPostSettings from './components/edit-post-settings';\n\nclass Editor extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.getEditorSettings = memize( this.getEditorSettings, {\n\t\t\tmaxSize: 1,\n\t\t} );\n\t}\n\n\tgetEditorSettings(\n\t\tsettings,\n\t\thasFixedToolbar,\n\t\tfocusMode,\n\t\thasReducedUI,\n\t\thasThemeStyles,\n\t\thiddenBlockTypes,\n\t\tblockTypes,\n\t\tpreferredStyleVariations,\n\t\t__experimentalLocalAutosaveInterval,\n\t\t__experimentalSetIsInserterOpened,\n\t\tupdatePreferredStyleVariations,\n\t\tkeepCaretInsideBlock\n\t) {\n\t\tsettings = {\n\t\t\t...( hasThemeStyles\n\t\t\t\t? settings\n\t\t\t\t: omit( settings, [ 'defaultEditorStyles' ] ) ),\n\t\t\t__experimentalPreferredStyleVariations: {\n\t\t\t\tvalue: preferredStyleVariations,\n\t\t\t\tonChange: updatePreferredStyleVariations,\n\t\t\t},\n\t\t\thasFixedToolbar,\n\t\t\tfocusMode,\n\t\t\thasReducedUI,\n\t\t\t__experimentalLocalAutosaveInterval,\n\n\t\t\t// This is marked as experimental to give time for the quick inserter to mature.\n\t\t\t__experimentalSetIsInserterOpened,\n\t\t\tkeepCaretInsideBlock,\n\t\t\tstyles: hasThemeStyles\n\t\t\t\t? settings.styles\n\t\t\t\t: settings.defaultEditorStyles,\n\t\t};\n\n\t\t// Omit hidden block types if exists and non-empty.\n\t\tif ( size( hiddenBlockTypes ) > 0 ) {\n\t\t\t// Defer to passed setting for `allowedBlockTypes` if provided as\n\t\t\t// anything other than `true` (where `true` is equivalent to allow\n\t\t\t// all block types).\n\t\t\tconst defaultAllowedBlockTypes =\n\t\t\t\ttrue === settings.allowedBlockTypes\n\t\t\t\t\t? map( blockTypes, 'name' )\n\t\t\t\t\t: settings.allowedBlockTypes || [];\n\n\t\t\tsettings.allowedBlockTypes = without(\n\t\t\t\tdefaultAllowedBlockTypes,\n\t\t\t\t...hiddenBlockTypes\n\t\t\t);\n\t\t}\n\n\t\treturn settings;\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tsettings,\n\t\t\thasFixedToolbar,\n\t\t\tfocusMode,\n\t\t\thasReducedUI,\n\t\t\thasThemeStyles,\n\t\t\tpost,\n\t\t\tpostId,\n\t\t\tinitialEdits,\n\t\t\tonError,\n\t\t\thiddenBlockTypes,\n\t\t\tblockTypes,\n\t\t\tpreferredStyleVariations,\n\t\t\t__experimentalLocalAutosaveInterval,\n\t\t\tsetIsInserterOpened,\n\t\t\tupdatePreferredStyleVariations,\n\t\t\tkeepCaretInsideBlock,\n\t\t\t...props\n\t\t} = this.props;\n\n\t\tif ( ! post ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst editorSettings = this.getEditorSettings(\n\t\t\tsettings,\n\t\t\thasFixedToolbar,\n\t\t\tfocusMode,\n\t\t\thasReducedUI,\n\t\t\thasThemeStyles,\n\t\t\thiddenBlockTypes,\n\t\t\tblockTypes,\n\t\t\tpreferredStyleVariations,\n\t\t\t__experimentalLocalAutosaveInterval,\n\t\t\tsetIsInserterOpened,\n\t\t\tupdatePreferredStyleVariations,\n\t\t\tkeepCaretInsideBlock\n\t\t);\n\n\t\treturn (\n\t\t\t<StrictMode>\n\t\t\t\t<EditPostSettings.Provider value={ settings }>\n\t\t\t\t\t<SlotFillProvider>\n\t\t\t\t\t\t<DropZoneProvider>\n\t\t\t\t\t\t\t<EditorProvider\n\t\t\t\t\t\t\t\tsettings={ editorSettings }\n\t\t\t\t\t\t\t\tpost={ post }\n\t\t\t\t\t\t\t\tinitialEdits={ initialEdits }\n\t\t\t\t\t\t\t\tuseSubRegistry={ false }\n\t\t\t\t\t\t\t\t{ ...props }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<ErrorBoundary onError={ onError }>\n\t\t\t\t\t\t\t\t\t<EditorInitialization postId={ postId } />\n\t\t\t\t\t\t\t\t\t<Layout />\n\t\t\t\t\t\t\t\t\t<KeyboardShortcuts\n\t\t\t\t\t\t\t\t\t\tshortcuts={ preventEventDiscovery }\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</ErrorBoundary>\n\t\t\t\t\t\t\t\t<PostLockedModal />\n\t\t\t\t\t\t\t</EditorProvider>\n\t\t\t\t\t\t</DropZoneProvider>\n\t\t\t\t\t</SlotFillProvider>\n\t\t\t\t</EditPostSettings.Provider>\n\t\t\t</StrictMode>\n\t\t);\n\t}\n}\n\nexport default compose( [\n\twithSelect( ( select, { postId, postType } ) => {\n\t\tconst {\n\t\t\tisFeatureActive,\n\t\t\tgetPreference,\n\t\t\t__experimentalGetPreviewDeviceType,\n\t\t} = select( 'core/edit-post' );\n\t\tconst { getEntityRecord } = select( 'core' );\n\t\tconst { getBlockTypes } = select( 'core/blocks' );\n\n\t\treturn {\n\t\t\thasFixedToolbar:\n\t\t\t\tisFeatureActive( 'fixedToolbar' ) ||\n\t\t\t\t__experimentalGetPreviewDeviceType() !== 'Desktop',\n\t\t\tfocusMode: isFeatureActive( 'focusMode' ),\n\t\t\thasReducedUI: isFeatureActive( 'reducedUI' ),\n\t\t\thasThemeStyles: isFeatureActive( 'themeStyles' ),\n\t\t\tpost: getEntityRecord( 'postType', postType, postId ),\n\t\t\tpreferredStyleVariations: getPreference(\n\t\t\t\t'preferredStyleVariations'\n\t\t\t),\n\t\t\thiddenBlockTypes: getPreference( 'hiddenBlockTypes' ),\n\t\t\tblockTypes: getBlockTypes(),\n\t\t\t__experimentalLocalAutosaveInterval: getPreference(\n\t\t\t\t'localAutosaveInterval'\n\t\t\t),\n\t\t\tkeepCaretInsideBlock: isFeatureActive( 'keepCaretInsideBlock' ),\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst {\n\t\t\tupdatePreferredStyleVariations,\n\t\t\tsetIsInserterOpened,\n\t\t} = dispatch( 'core/edit-post' );\n\t\treturn {\n\t\t\tupdatePreferredStyleVariations,\n\t\t\tsetIsInserterOpened,\n\t\t};\n\t} ),\n] )( Editor );\n"]}