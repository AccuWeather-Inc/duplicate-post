{"version":3,"sources":["@wordpress/editor/src/components/provider/index.js"],"names":["fetchLinkSuggestions","search","isInitialSuggestions","type","subtype","page","perPageArg","perPage","disablePostFormats","queries","push","path","per_page","catch","Promise","all","then","results","filter","result","id","slice","url","title","EditorProvider","props","arguments","getBlockEditorSettings","maxSize","getDefaultBlockContext","recovery","updatePostLock","settings","postLock","setupEditor","post","initialEdits","template","autosave","createWarningNotice","actions","label","editLink","reusableBlocks","hasUploadPermissions","canUserUseUnfilteredHTML","undo","shouldInsertAtTheTop","mediaUpload","undefined","__experimentalReusableBlocks","__experimentalFetchLinkSuggestions","__experimentalCanUserUseUnfilteredHTML","__experimentalUndo","__experimentalShouldInsertAtTheTop","postId","postType","updateEditorSettings","prevProps","tearDownEditor","children","blocks","resetEditorBlocks","selectionStart","selectionEnd","isReady","resetEditorBlocksWithoutUndoLevel","isPostTitleSelected","editorSettings","defaultBlockContext","styles","Component","withRegistryProvider","select","isEditorReady","__unstableIsEditorReady","getEditorBlocks","getEditorSelectionStart","getEditorSelectionEnd","canUser","getEntityRecords","dispatch","__experimentalTearDownEditor","options","__unstableShouldCreateUndoLevel"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { map, pick, defaultTo, flatten, partialRight } from 'lodash';\nimport memize from 'memize';\n\n/**\n * WordPress dependencies\n */\nimport { compose } from '@wordpress/compose';\nimport { Component } from '@wordpress/element';\nimport { withDispatch, withSelect } from '@wordpress/data';\nimport { __ } from '@wordpress/i18n';\nimport { EntityProvider } from '@wordpress/core-data';\nimport {\n\tBlockEditorProvider,\n\tBlockContextProvider,\n\t__unstableEditorStyles as EditorStyles,\n} from '@wordpress/block-editor';\nimport apiFetch from '@wordpress/api-fetch';\nimport { addQueryArgs } from '@wordpress/url';\nimport { decodeEntities } from '@wordpress/html-entities';\nimport { ReusableBlocksMenuItems } from '@wordpress/reusable-blocks';\n\n/**\n * Internal dependencies\n */\nimport withRegistryProvider from './with-registry-provider';\nimport { mediaUpload } from '../../utils';\nimport ConvertToGroupButtons from '../convert-to-group-buttons';\n\n/**\n * Fetches link suggestions from the API. This function is an exact copy of a function found at:\n *\n * packages/edit-navigation/src/index.js\n *\n * It seems like there is no suitable package to import this from. Ideally it would be either part of core-data.\n * Until we refactor it, just copying the code is the simplest solution.\n *\n * @param {string} search\n * @param {Object} [searchArguments]\n * @param {number} [searchArguments.isInitialSuggestions]\n * @param {number} [searchArguments.type]\n * @param {number} [searchArguments.subtype]\n * @param {number} [searchArguments.page]\n * @param {Object} [editorSettings]\n * @param {boolean} [editorSettings.disablePostFormats=false]\n * @return {Promise<Object[]>} List of suggestions\n */\n\nconst fetchLinkSuggestions = async (\n\tsearch,\n\t{ isInitialSuggestions, type, subtype, page, perPage: perPageArg } = {},\n\t{ disablePostFormats = false } = {}\n) => {\n\tconst perPage = perPageArg || isInitialSuggestions ? 3 : 20;\n\n\tconst queries = [];\n\n\tif ( ! type || type === 'post' ) {\n\t\tqueries.push(\n\t\t\tapiFetch( {\n\t\t\t\tpath: addQueryArgs( '/wp/v2/search', {\n\t\t\t\t\tsearch,\n\t\t\t\t\tpage,\n\t\t\t\t\tper_page: perPage,\n\t\t\t\t\ttype: 'post',\n\t\t\t\t\tsubtype,\n\t\t\t\t} ),\n\t\t\t} ).catch( () => [] ) // fail by returning no results\n\t\t);\n\t}\n\n\tif ( ! type || type === 'term' ) {\n\t\tqueries.push(\n\t\t\tapiFetch( {\n\t\t\t\tpath: addQueryArgs( '/wp/v2/search', {\n\t\t\t\t\tsearch,\n\t\t\t\t\tpage,\n\t\t\t\t\tper_page: perPage,\n\t\t\t\t\ttype: 'term',\n\t\t\t\t\tsubtype,\n\t\t\t\t} ),\n\t\t\t} ).catch( () => [] )\n\t\t);\n\t}\n\n\tif ( ! disablePostFormats && ( ! type || type === 'post-format' ) ) {\n\t\tqueries.push(\n\t\t\tapiFetch( {\n\t\t\t\tpath: addQueryArgs( '/wp/v2/search', {\n\t\t\t\t\tsearch,\n\t\t\t\t\tpage,\n\t\t\t\t\tper_page: perPage,\n\t\t\t\t\ttype: 'post-format',\n\t\t\t\t\tsubtype,\n\t\t\t\t} ),\n\t\t\t} ).catch( () => [] )\n\t\t);\n\t}\n\n\treturn Promise.all( queries ).then( ( results ) => {\n\t\treturn map(\n\t\t\tflatten( results )\n\t\t\t\t.filter( ( result ) => !! result.id )\n\t\t\t\t.slice( 0, perPage ),\n\t\t\t( result ) => ( {\n\t\t\t\tid: result.id,\n\t\t\t\turl: result.url,\n\t\t\t\ttitle: decodeEntities( result.title ) || __( '(no title)' ),\n\t\t\t\ttype: result.subtype || result.type,\n\t\t\t} )\n\t\t);\n\t} );\n};\n\nclass EditorProvider extends Component {\n\tconstructor( props ) {\n\t\tsuper( ...arguments );\n\n\t\tthis.getBlockEditorSettings = memize( this.getBlockEditorSettings, {\n\t\t\tmaxSize: 1,\n\t\t} );\n\n\t\tthis.getDefaultBlockContext = memize( this.getDefaultBlockContext, {\n\t\t\tmaxSize: 1,\n\t\t} );\n\n\t\t// Assume that we don't need to initialize in the case of an error recovery.\n\t\tif ( props.recovery ) {\n\t\t\treturn;\n\t\t}\n\n\t\tprops.updatePostLock( props.settings.postLock );\n\t\tprops.setupEditor(\n\t\t\tprops.post,\n\t\t\tprops.initialEdits,\n\t\t\tprops.settings.template\n\t\t);\n\n\t\tif ( props.settings.autosave ) {\n\t\t\tprops.createWarningNotice(\n\t\t\t\t__(\n\t\t\t\t\t'There is an autosave of this post that is more recent than the version below.'\n\t\t\t\t),\n\t\t\t\t{\n\t\t\t\t\tid: 'autosave-exists',\n\t\t\t\t\tactions: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: __( 'View the autosave' ),\n\t\t\t\t\t\t\turl: props.settings.autosave.editLink,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\tgetBlockEditorSettings(\n\t\tsettings,\n\t\treusableBlocks,\n\t\thasUploadPermissions,\n\t\tcanUserUseUnfilteredHTML,\n\t\tundo,\n\t\tshouldInsertAtTheTop\n\t) {\n\t\treturn {\n\t\t\t...pick( settings, [\n\t\t\t\t'__experimentalBlockDirectory',\n\t\t\t\t'__experimentalBlockPatterns',\n\t\t\t\t'__experimentalBlockPatternCategories',\n\t\t\t\t'__experimentalEnableFullSiteEditing',\n\t\t\t\t'__experimentalEnableFullSiteEditingDemo',\n\t\t\t\t'__experimentalFeatures',\n\t\t\t\t'__experimentalGlobalStylesUserEntityId',\n\t\t\t\t'__experimentalGlobalStylesBaseStyles',\n\t\t\t\t'__experimentalGlobalStylesContexts',\n\t\t\t\t'__experimentalPreferredStyleVariations',\n\t\t\t\t'__experimentalSetIsInserterOpened',\n\t\t\t\t'alignWide',\n\t\t\t\t'allowedBlockTypes',\n\t\t\t\t'availableLegacyWidgets',\n\t\t\t\t'bodyPlaceholder',\n\t\t\t\t'codeEditingEnabled',\n\t\t\t\t'colors',\n\t\t\t\t'disableCustomColors',\n\t\t\t\t'disableCustomFontSizes',\n\t\t\t\t'disableCustomGradients',\n\t\t\t\t'enableCustomUnits',\n\t\t\t\t'enableCustomLineHeight',\n\t\t\t\t'focusMode',\n\t\t\t\t'fontSizes',\n\t\t\t\t'gradients',\n\t\t\t\t'hasFixedToolbar',\n\t\t\t\t'hasReducedUI',\n\t\t\t\t'imageEditing',\n\t\t\t\t'imageSizes',\n\t\t\t\t'imageDimensions',\n\t\t\t\t'isRTL',\n\t\t\t\t'keepCaretInsideBlock',\n\t\t\t\t'maxWidth',\n\t\t\t\t'onUpdateDefaultBlockStyles',\n\t\t\t\t'styles',\n\t\t\t\t'template',\n\t\t\t\t'templateLock',\n\t\t\t\t'titlePlaceholder',\n\t\t\t] ),\n\t\t\tmediaUpload: hasUploadPermissions ? mediaUpload : undefined,\n\t\t\t__experimentalReusableBlocks: reusableBlocks,\n\t\t\t__experimentalFetchLinkSuggestions: partialRight(\n\t\t\t\tfetchLinkSuggestions,\n\t\t\t\tsettings\n\t\t\t),\n\t\t\t__experimentalCanUserUseUnfilteredHTML: canUserUseUnfilteredHTML,\n\t\t\t__experimentalUndo: undo,\n\t\t\t__experimentalShouldInsertAtTheTop: shouldInsertAtTheTop,\n\t\t};\n\t}\n\n\tgetDefaultBlockContext( postId, postType ) {\n\t\treturn { postId, postType };\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.props.updateEditorSettings( this.props.settings );\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\tif ( this.props.settings !== prevProps.settings ) {\n\t\t\tthis.props.updateEditorSettings( this.props.settings );\n\t\t}\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis.props.tearDownEditor();\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tcanUserUseUnfilteredHTML,\n\t\t\tchildren,\n\t\t\tpost,\n\t\t\tblocks,\n\t\t\tresetEditorBlocks,\n\t\t\tselectionStart,\n\t\t\tselectionEnd,\n\t\t\tisReady,\n\t\t\tsettings,\n\t\t\treusableBlocks,\n\t\t\tresetEditorBlocksWithoutUndoLevel,\n\t\t\thasUploadPermissions,\n\t\t\tisPostTitleSelected,\n\t\t\tundo,\n\t\t} = this.props;\n\n\t\tif ( ! isReady ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst editorSettings = this.getBlockEditorSettings(\n\t\t\tsettings,\n\t\t\treusableBlocks,\n\t\t\thasUploadPermissions,\n\t\t\tcanUserUseUnfilteredHTML,\n\t\t\tundo,\n\t\t\tisPostTitleSelected\n\t\t);\n\n\t\tconst defaultBlockContext = this.getDefaultBlockContext(\n\t\t\tpost.id,\n\t\t\tpost.type\n\t\t);\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<EditorStyles styles={ settings.styles } />\n\t\t\t\t<EntityProvider kind=\"root\" type=\"site\">\n\t\t\t\t\t<EntityProvider\n\t\t\t\t\t\tkind=\"postType\"\n\t\t\t\t\t\ttype={ post.type }\n\t\t\t\t\t\tid={ post.id }\n\t\t\t\t\t>\n\t\t\t\t\t\t<BlockContextProvider value={ defaultBlockContext }>\n\t\t\t\t\t\t\t<BlockEditorProvider\n\t\t\t\t\t\t\t\tvalue={ blocks }\n\t\t\t\t\t\t\t\tonInput={ resetEditorBlocksWithoutUndoLevel }\n\t\t\t\t\t\t\t\tonChange={ resetEditorBlocks }\n\t\t\t\t\t\t\t\tselectionStart={ selectionStart }\n\t\t\t\t\t\t\t\tselectionEnd={ selectionEnd }\n\t\t\t\t\t\t\t\tsettings={ editorSettings }\n\t\t\t\t\t\t\t\tuseSubRegistry={ false }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ children }\n\t\t\t\t\t\t\t\t<ReusableBlocksMenuItems />\n\t\t\t\t\t\t\t\t<ConvertToGroupButtons />\n\t\t\t\t\t\t\t</BlockEditorProvider>\n\t\t\t\t\t\t</BlockContextProvider>\n\t\t\t\t\t</EntityProvider>\n\t\t\t\t</EntityProvider>\n\t\t\t</>\n\t\t);\n\t}\n}\n\nexport default compose( [\n\twithRegistryProvider,\n\twithSelect( ( select ) => {\n\t\tconst {\n\t\t\tcanUserUseUnfilteredHTML,\n\t\t\t__unstableIsEditorReady: isEditorReady,\n\t\t\tgetEditorBlocks,\n\t\t\tgetEditorSelectionStart,\n\t\t\tgetEditorSelectionEnd,\n\t\t\tisPostTitleSelected,\n\t\t} = select( 'core/editor' );\n\t\tconst { canUser } = select( 'core' );\n\n\t\treturn {\n\t\t\tcanUserUseUnfilteredHTML: canUserUseUnfilteredHTML(),\n\t\t\tisReady: isEditorReady(),\n\t\t\tblocks: getEditorBlocks(),\n\t\t\tselectionStart: getEditorSelectionStart(),\n\t\t\tselectionEnd: getEditorSelectionEnd(),\n\t\t\treusableBlocks: select( 'core' ).getEntityRecords(\n\t\t\t\t'postType',\n\t\t\t\t'wp_block',\n\t\t\t\t{ per_page: -1 }\n\t\t\t),\n\t\t\thasUploadPermissions: defaultTo(\n\t\t\t\tcanUser( 'create', 'media' ),\n\t\t\t\ttrue\n\t\t\t),\n\t\t\t// This selector is only defined on mobile.\n\t\t\tisPostTitleSelected: isPostTitleSelected && isPostTitleSelected(),\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst {\n\t\t\tsetupEditor,\n\t\t\tupdatePostLock,\n\t\t\tresetEditorBlocks,\n\t\t\tupdateEditorSettings,\n\t\t\t__experimentalTearDownEditor,\n\t\t\tundo,\n\t\t} = dispatch( 'core/editor' );\n\t\tconst { createWarningNotice } = dispatch( 'core/notices' );\n\n\t\treturn {\n\t\t\tsetupEditor,\n\t\t\tupdatePostLock,\n\t\t\tcreateWarningNotice,\n\t\t\tresetEditorBlocks,\n\t\t\tupdateEditorSettings,\n\t\t\tresetEditorBlocksWithoutUndoLevel( blocks, options ) {\n\t\t\t\tresetEditorBlocks( blocks, {\n\t\t\t\t\t...options,\n\t\t\t\t\t__unstableShouldCreateUndoLevel: false,\n\t\t\t\t} );\n\t\t\t},\n\t\t\ttearDownEditor: __experimentalTearDownEditor,\n\t\t\tundo,\n\t\t};\n\t} ),\n] )( EditorProvider );\n"]}